colors = c("white", "burlywood3", "brown3"),
lab = T,
show.legend = T,
title = "Values of the comparison metric \nTP53 sh1 silencing - \"Molecular function\" GO terms")
r.cp = c(1, 0.92, 0.93, 0.4)
r.panther = c(0.66, 1, 0.81, 0.38)
r.gsea = c(0.32, 0.37, 1, 0.4)
r.rs50 = c(0.17, 0.19, 0.30, 1)
names <- c("cp", "panther", "gsea", "rs50")
m <- matrix(data = c(r.cp, r.panther, r.gsea, r.rs50),
nrow = length(names), ncol = length(names))
colnames(m) <- names
rownames(m) <- names
ggcorrplot(m, outline.col = "white",
ggtheme = ggplot2::theme_minimal,
colors = c("white", "burlywood3", "brown3"),
lab = T,
show.legend = T,
title = "Values of the comparison metric \nLINC01605 knockout - \"Biological process\" GO terms"))
ggcorrplot(m, outline.col = "white",
ggtheme = ggplot2::theme_minimal,
colors = c("white", "burlywood3", "brown3"),
lab = T,
show.legend = T,
title = "Values of the comparison metric \nLINC01605 knockout - \"Biological process\" GO terms")
r.cp = c(1, 0.94, 0.79, 0.54, 0.52)
r.panther = c(0.78, 1, 0.79, 0.54, 0.52)
r.gsea = c(0.58, 0.75, 1, 0.56, 0.51)
r.rs350 = c(0.23, 0.28, 0.30, 1, 0.24)
r.rs200 = c(0.24, 0.28, 0.31, 0.28, 1)
names <- c("cp", "panther", "gsea", "rs350", "rs200")
m <- matrix(data = c(r.cp, r.panther, r.gsea, r.rs350, r.rs200),
nrow = length(names), ncol = length(names))
colnames(m) <- names
rownames(m) <- names
ggcorrplot(m, outline.col = "white",
ggtheme = ggplot2::theme_minimal,
colors = c("white", "burlywood3", "brown3"),
lab = T,
show.legend = T,
title = "Values of the comparison metric \nTP53 sh1 silencing - \"Biological process\" GO terms")
r.cp = c(1, 0.81, 0.75, 0.10, 0.15)
r.panther = c(0.6, 1, 0.82, 0.23, 0.15)
r.gsea = c(0.37, 0.53, 1, 0.24, 0.22)
r.rs350 = c(0.02, 0.07, 0.11, 1, 0.11)
r.rs200 = c(0.05, 0.09, 0.15, 0.16, 1)
names <- c("cp", "panther", "gsea", "rs350", "rs200")
m <- matrix(data = c(r.cp, r.panther, r.gsea, r.rs350, r.rs200),
nrow = length(names), ncol = length(names))
colnames(m) <- names
rownames(m) <- names
ggcorrplot(m, outline.col = "white",
ggtheme = ggplot2::theme_minimal,
colors = c("white", "burlywood3", "brown3"),
lab = T,
show.legend = T,
title = "Values of the comparison metric \nTP53 sh1 silencing - \"Molecular function\" GO terms")
b <- ggcorrplot(m, outline.col = "white",
ggtheme = ggplot2::theme_minimal,
colors = c("white", "burlywood3", "brown3"),
lab = T,
show.legend = T,
title = "Values of the comparison metric \nTP53 sh1 silencing - \"Molecular function\" GO terms")
library(ggcorrplot)
r.cp = c(1, 0.94, 0.79, 0.54, 0.52)
r.panther = c(0.78, 1, 0.79, 0.54, 0.52)
r.gsea = c(0.58, 0.75, 1, 0.56, 0.51)
r.rs350 = c(0.23, 0.28, 0.30, 1, 0.24)
r.rs200 = c(0.24, 0.28, 0.31, 0.28, 1)
names <- c("cp", "panther", "gsea", "rs350", "rs200")
m <- matrix(data = c(r.cp, r.panther, r.gsea, r.rs350, r.rs200),
nrow = length(names), ncol = length(names))
colnames(m) <- names
rownames(m) <- names
a <- ggcorrplot(m, outline.col = "white",
ggtheme = ggplot2::theme_minimal,
colors = c("white", "burlywood3", "brown3"),
lab = T,
show.legend = T,
title = "Values of the comparison metric \nTP53 sh1 silencing - \"Biological process\" GO terms")
r.cp = c(1, 0.81, 0.75, 0.10, 0.15)
r.panther = c(0.6, 1, 0.82, 0.23, 0.15)
r.gsea = c(0.37, 0.53, 1, 0.24, 0.22)
r.rs350 = c(0.02, 0.07, 0.11, 1, 0.11)
r.rs200 = c(0.05, 0.09, 0.15, 0.16, 1)
names <- c("cp", "panther", "gsea", "rs350", "rs200")
m <- matrix(data = c(r.cp, r.panther, r.gsea, r.rs350, r.rs200),
nrow = length(names), ncol = length(names))
colnames(m) <- names
rownames(m) <- names
b <- ggcorrplot(m, outline.col = "white",
ggtheme = ggplot2::theme_minimal,
colors = c("white", "burlywood3", "brown3"),
lab = T,
show.legend = T,
title = "Values of the comparison metric \nTP53 sh1 silencing - \"Molecular function\" GO terms")
library(ggpubr)
ggarrange(a, b, ncol = 2, nrow = 1)
a <- ggcorrplot(m, outline.col = "white",
ggtheme = ggplot2::theme_minimal,
colors = c("white", "burlywood3", "brown3"),
lab = T,
show.legend = F,
title = "Values of the comparison metric \nTP53 sh1 silencing - \"Biological process\" GO terms")
ggarrange(a, b, ncol = 2, nrow = 1)
r.cp = c(1, 0.81, 0.75, 0.10, 0.15)
r.panther = c(0.6, 1, 0.82, 0.23, 0.15)
r.gsea = c(0.37, 0.53, 1, 0.24, 0.22)
r.rs350 = c(0.02, 0.07, 0.11, 1, 0.11)
r.rs200 = c(0.05, 0.09, 0.15, 0.16, 1)
names <- c("cp", "panther", "gsea", "rs350", "rs200")
m <- matrix(data = c(r.cp, r.panther, r.gsea, r.rs350, r.rs200),
nrow = length(names), ncol = length(names))
colnames(m) <- names
rownames(m) <- names
ggcorrplot(m, outline.col = "white",
ggtheme = ggplot2::theme_minimal,
colors = c("white", "burlywood3", "brown3"),
lab = T,
show.legend = T,
title = "Values of the comparison metric \nTP53 sh1 silencing - \"Molecular function\" GO terms")
r.cp = c(1, 0.94, 0.79, 0.54, 0.52)
r.panther = c(0.78, 1, 0.79, 0.54, 0.52)
r.gsea = c(0.58, 0.75, 1, 0.56, 0.51)
r.rs350 = c(0.23, 0.28, 0.30, 1, 0.24)
r.rs200 = c(0.24, 0.28, 0.31, 0.28, 1)
names <- c("cp", "panther", "gsea", "rs350", "rs200")
m <- matrix(data = c(r.cp, r.panther, r.gsea, r.rs350, r.rs200),
nrow = length(names), ncol = length(names))
colnames(m) <- names
rownames(m) <- names
ggcorrplot(m, outline.col = "white",
ggtheme = ggplot2::theme_minimal,
colors = c("white", "burlywood3", "brown3"),
lab = T,
show.legend = T,
title = "Values of the comparison metric \nTP53 sh1 silencing - \"Biological process\" GO terms")
library(readr)
library(dplyr)
exp <- "sh1" # sh1 | linc_ko
pval <- "00001"
setwd("/mnt/hdd0/univ/lab2/")
GO <- "BP"
cp <- read_csv(paste0("05-10/clusterProfiler/", exp, "/pval", pval, "/revigo/", GO, ".csv"))
panther <- read_csv(paste0("05-10/Panther/", exp, "/pval", pval, "/revigo/", GO, ".csv"))
gsea <- read_csv(paste0("05-10/GSEA/", exp, "/pval", pval, "/revigo/", GO, ".csv"))
rs350 <- read_csv(paste0("05-10/random_samples_goterms/sample350t/revigo/", GO, ".csv"))
rs200 <- read_csv(paste0("05-10/random_samples_goterms/sample200t/revigo/", GO, ".csv"))
setwd("/mnt/hdd0/univ/lab2/")
GO <- "MF"
cp <- read_csv(paste0("05-10/clusterProfiler/", exp, "/pval", pval, "/revigo/", GO, ".csv"))
panther <- read_csv(paste0("05-10/Panther/", exp, "/pval", pval, "/revigo/", GO, ".csv"))
gsea <- read_csv(paste0("05-10/GSEA/", exp, "/pval", pval, "/revigo/", GO, ".csv"))
rs350 <- read_csv(paste0("05-10/random_samples_goterms/sample350t/revigo/", GO, ".csv"))
rs200 <- read_csv(paste0("05-10/random_samples_goterms/sample200t/revigo/", GO, ".csv"))
View(cp)
View(panther)
View(gsea)
View(rs350)
View(rs350)
View(rs200)
setwd("/mnt/hdd0/univ/lab2/05-10/listSimilarity")
source("function.r")
library(readr)
library(dplyr)
exp <- "linc_ko" # sh1 | linc_ko
pval <- "0001"
setwd("/mnt/hdd0/univ/lab2/")
GO <- "BP"
cp <- read_csv(paste0("05-10/clusterProfiler/", exp, "/pval", pval, "/revigo/", GO, ".csv"))
panther <- read_csv(paste0("05-10/Panther/", exp, "/pval", pval, "/revigo/", GO, ".csv"))
gsea <- read_csv(paste0("05-10/GSEA/", exp, "/pval", pval, "/revigo/", GO, ".csv"))
rs50 <- read_csv(paste0("05-10/random_samples_goterms/sample50t/revigo/", GO, ".csv"))
library(ggcorrplot)
r.cp = c(1, 0.92, 0.93, 0.4)
r.panther = c(0.66, 1, 0.81, 0.38)
r.gsea = c(0.32, 0.37, 1, 0.4)
r.rs50 = c(0.17, 0.19, 0.30, 1)
names <- c("cp", "panther", "gsea", "rs50")
m <- matrix(data = c(r.cp, r.panther, r.gsea, r.rs50),
nrow = length(names), ncol = length(names))
colnames(m) <- names
rownames(m) <- names
ggcorrplot(m, outline.col = "white",
ggtheme = ggplot2::theme_minimal,
colors = c("white", "burlywood3", "brown3"),
lab = T,
show.legend = T,
title = "Values of the comparison metric \nLINC01605 knockout - \"Biological process\" GO terms")
setwd("/mnt/hdd0/univ/thesis-support-material/data/4-5")
library(readr)
library(dplyr)
library(ggplot2)
n_h3k27ac <- 58201
data.frame(sites = rep(c("p53", "random 1", "random 2", "random 3") , 2),
value = c(7256, 353, 376, 344)) %>%
ggplot(mapping = aes(x = sites, y = value, fill = sites)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("coral3", "dodgerblue1", "dodgerblue2", "dodgerblue3")) +
geom_text(aes(label = value), vjust=-0.5, size=5, color = "black", position = position_dodge(0.9)) +
geom_text(aes(label = paste0(format(round(value/n_h3k27ac*100, 1), nsmall = 1), "%")),
vjust=1.5, size=4, color = "white", position = position_dodge(0.9)) +
theme_minimal() +
theme(legend.position = c(0.9,0.85)) +
labs(title = "Number of H3K27ac sites containing a p53 binding site", x = "", y = "Sites")
# for each h3k27ac region on a p53 binding site: the coordinates of region and site and the name, logfc, distance of
# the closest DE gene
gene_symbol_Enseml_mapping <- read_delim("gene-symbol-Enseml-mapping.txt",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
closest_DEgene_sh1 <- read_delim("question1/2-closest_DE_gene/closest-gene/closest_DEgene_sh1.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
intersections_h3k27ac_p53 <- read_delim("question1/2-closest_DE_gene/intersections-h3k27ac_p53/intersections.txt",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
DESeq2_DE_sh1 <- read_delim("question1/aux/DESeq2_DE_sh1.txt",
"\t", escape_double = FALSE, trim_ws = TRUE)
colnames(intersections_h3k27ac_p53) <- c("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "name_h3k27ac",
"chr_p53", "start_p53", "end_p53", "name_p53", "overlap")
colnames(closest_DEgene_sh1) <- c("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "name_h3k27ac",
"chr_gene", "start_gene", "end_gene", "name_gene", "nd", "strand", "distance")
temp <- closest_DEgene_sh1 %>%
select("name_h3k27ac", "chr_gene", "start_gene", "end_gene", "name_gene", "distance")
intersections_h3k27ac_p53 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene" = "gene")) %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "name_gene", "log2FoldChange", "distance") %>%
mutate(name_gene = substr(name_gene, 0, 15)) %>%
inner_join(gene_symbol_Enseml_mapping, by = c("name_gene" = "X1")) %>%
rename("gene name" = "X2") %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "gene name", "log2FoldChange", "distance") %>%
View()
rm(temp)
rm(closest_DEgene_sh1, DESeq2_DE_sh1, gene_symbol_Enseml_mapping, intersections_h3k27ac_p53)
genes_within_1MB <- read_table2("question1/3-genes_within_1MB_from_1/a-genes_within_1MB/genes_within_1MB.txt",
col_names = FALSE)
# importing the DE genes in sh1 vs shNT and in sh2 vs shNT, then keeping only those DE in both experiments
DE_common_sh1 <- read_delim("/mnt/hdd0/univ/thesis-support-material/data/4-4/sites-on-DE-genes/genes/DE_common_sh1_namepos.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
DE_common_sh2 <- read_delim("/mnt/hdd0/univ/thesis-support-material/data/4-4/sites-on-DE-genes/genes/DE_common_sh2_namepos.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
DE_sh1sh2 <- (DE_common_sh1 %>% inner_join(DE_common_sh2))
genes_within_1MB <- genes_within_1MB %>%
mutate(isDE = X8 %in% DE_sh1sh2$X4)
colnames(genes_within_1MB) <- c("chr_h", "start_h", "end_h", "region_name",
"chr_g", "start_g", "end_g", "gene_name",
"nd", "gene_strand", "distance", "isGeneDE" )
a <- genes_within_1MB %>%
dplyr::group_by(chr_h, start_h, end_h, region_name) %>%
dplyr::summarise(nGenes = n(), nGenesDE = sum(isGeneDE[isGeneDE])) %>%
dplyr::mutate(fractionOfDEPercent = 100 * nGenesDE / nGenes) %>%
dplyr::filter(nGenes >= 10) %>%
dplyr::arrange(-fractionOfDEPercent)
nodes <-  a %>%
select(region_name, chr_h, start_h, end_h, fractionOfDEPercent) %>%
mutate(ycoord = as.integer(substr(chr_h, 4, 10)))
DE_sh1sh2 <- DE_sh1sh2 %>%
mutate(ycoord = as.integer(substr(X1, 4, 99)))
DE_sh1sh2 <- DE_sh1sh2 %>%
mutate(ycoord = as.integer(substr(X1, 4, 99)))
DE_sh1sh2
DE_sh1sh2 %>%
mutate(ycoord = as.integer(substr(X1, 4, 99)))
DE_sh1sh2 <- DE_sh1sh2 %>%
dplyr::mutate(ycoord = as.integer(substr(X1, 4, 99)))
DE_sh1sh2 %>%
dplyr::mutate(ycoord = as.integer(substr(X1, 4, 99)))
View(DE_sh1sh2)
nodes %>%
filter(fractionOfDEPercent > 3.0) %>%
ggplot() +
geom_hline(mapping = aes(yintercept = ycoord), color = "gray80") +
geom_point(mapping = aes(x = start_h, y = ycoord, size = fractionOfDEPercent, color = as.factor(ycoord))) +
#geom_point(mapping = aes(x = start_h, y = ycoord,size = fractionOfDEPercent), colour = "black", shape = 1) +
scale_color_discrete(guide = F) +
scale_size_continuous(range = c(2,12), name = "% of DE genes within 1MB") +
geom_point(data = DE_sh1sh2, mapping = aes(x = X2, y = ycoord), color = "black", shape = 4) +
theme_classic() +
theme(legend.position = c(0.9, 0.9) ) +
labs(title = "H3K27ac regions having DE genes within 1M base pairs") +
xlab("Position within the chromosome") +
ylab("Chromosome number")
genes_within_1MB
View(genes_within_1MB)
View(a)
View(a)
View(genes_within_1MB)
setwd("/mnt/hdd0/univ/thesis-support-material/data/4-5")
library(readr)
library(dplyr)
library(ggplot2)
n_h3k27ac <- 58201
data.frame(sites = rep(c("p53", "random 1", "random 2", "random 3") , 2),
value = c(7256, 353, 376, 344)) %>%
ggplot(mapping = aes(x = sites, y = value, fill = sites)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("coral3", "dodgerblue1", "dodgerblue2", "dodgerblue3")) +
geom_text(aes(label = value), vjust=-0.5, size=5, color = "black", position = position_dodge(0.9)) +
geom_text(aes(label = paste0(format(round(value/n_h3k27ac*100, 1), nsmall = 1), "%")),
vjust=1.5, size=4, color = "white", position = position_dodge(0.9)) +
theme_minimal() +
theme(legend.position = c(0.9,0.85)) +
labs(title = "Number of H3K27ac sites containing a p53 binding site", x = "", y = "Sites")
gene_symbol_Enseml_mapping <- read_delim("gene-symbol-Enseml-mapping.txt",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
closest_DEgene_sh1 <- read_delim("question1/2-closest_DE_gene/closest-gene/closest_DEgene_sh1.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
intersections_h3k27ac_p53 <- read_delim("question1/2-closest_DE_gene/intersections-h3k27ac_p53/intersections.txt",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
DESeq2_DE_sh1 <- read_delim("question1/aux/DESeq2_DE_sh1.txt",
"\t", escape_double = FALSE, trim_ws = TRUE)
colnames(intersections_h3k27ac_p53) <- c("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "name_h3k27ac",
"chr_p53", "start_p53", "end_p53", "name_p53", "overlap")
colnames(closest_DEgene_sh1) <- c("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "name_h3k27ac",
"chr_gene", "start_gene", "end_gene", "name_gene", "nd", "strand", "distance")
temp <- closest_DEgene_sh1 %>%
select("name_h3k27ac", "chr_gene", "start_gene", "end_gene", "name_gene", "distance")
intersections_h3k27ac_p53 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene" = "gene")) %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "name_gene", "log2FoldChange", "distance") %>%
mutate(name_gene = substr(name_gene, 0, 15)) %>%
inner_join(gene_symbol_Enseml_mapping, by = c("name_gene" = "X1")) %>%
rename("gene name" = "X2") %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "gene name", "log2FoldChange", "distance") %>%
View()
intersections_h3k27ac_p53 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene" = "gene")) %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "name_gene", "log2FoldChange", "distance") %>%
mutate(name_gene = substr(name_gene, 0, 15)) %>%
inner_join(gene_symbol_Enseml_mapping, by = c("name_gene" = "X1")) %>%
rename("gene name" = "X2") %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "gene name", "log2FoldChange", "distance") %>%
View()
table1 <- intersections_h3k27ac_p53 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene" = "gene")) %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "name_gene", "log2FoldChange", "distance") %>%
mutate(name_gene = substr(name_gene, 0, 15)) %>%
inner_join(gene_symbol_Enseml_mapping, by = c("name_gene" = "X1")) %>%
rename("gene name" = "X2") %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "gene name", "log2FoldChange", "distance") %>%
View()
table1 <- intersections_h3k27ac_p53 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene" = "gene")) %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "name_gene", "log2FoldChange", "distance") %>%
mutate(name_gene = substr(name_gene, 0, 15)) %>%
inner_join(gene_symbol_Enseml_mapping, by = c("name_gene" = "X1")) %>%
rename("gene name" = "X2") %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "gene name", "log2FoldChange", "distance")
View(table1)
View(table1)
table1 %>% filter(chr_h3k27ac == "chr8") %>% filter(max(end_h3k27ac, 37411701) - min(start_h3k27ac, 37278859) < (end_h3k27ac - start_h3k27ac) + (37411701-37278859))
table1 %>% filter(chr_h3k27ac == "chr8")
table1 %>% filter(chr_h3k27ac == "chr8") %>% View()
table1 %>% filter(chr_h3k27ac == "chr8") %>% filter(start_h3k27ac >= 37278859 && end_h3k27ac <= 37411701)
b1 = 37278859
b2 = 37411701
table1 %>% filter(chr_h3k27ac == "chr8") %>% filter(start_h3k27ac >= b1 && end_h3k27ac <= b2)
table1 %>% filter(chr_h3k27ac == "chr8") %>% filter(start_h3k27ac >= b1 & end_h3k27ac <= b2)
# LINC01605:
#chr8:37278859-37411701
b1 <- 37278859
b2 <- 37411701
table1 %>% filter(chr_h3k27ac == "chr8") %>% filter(start_h3k27ac >= b1 & end_h3k27ac <= b2)
View(genes_within_1MB)
a
a %>% filter(chr_h == "chr8")
a %>% filter(chr_h == "chr8", start_h %in% c(37371529,37373258,37397879,37401725))
a %>% filter(chr_h == "chr8", start_h %in% c(37371529,37373258,37397879,37401725))
View(intersections_h3k27ac_p53)
closest_DEgene_sh1 <- read_delim("question2/3-closest_DE_gene/closest_DEgene_sh1.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
View(closest_DEgene_sh1)
closest_DEgene_sh1
colnames(closest_DEgene_sh1) <- c("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "name_h3k27ac",
"chr_gene", "start_gene", "end_gene", "name_gene", "nd", "strand", "distance")
closest_DEgene_sh1
closest_DEgene_sh1 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac"))
closest_DEgene_sh1 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene" = "gene")) %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "name_gene", "log2FoldChange", "distance") %>%
mutate(name_gene = substr(name_gene, 0, 15)) %>%
inner_join(gene_symbol_Enseml_mapping, by = c("name_gene" = "X1")) %>%
rename("gene name" = "X2") %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "gene name", "log2FoldChange", "distance")
closest_DEgene_sh1 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene" = "gene"))
DESeq2_DE_sh1
closest_DEgene_sh1
closest_DEgene_sh1 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac"))
closest_DEgene_sh1 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene.x" = "gene"))
closest_DEgene_sh1 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene.x" = "gene")) %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "name_gene", "log2FoldChange", "distance")
closest_DEgene_sh1
intersections_h3k27ac_p53
closest_DEgene_sh1
intersections_h3k27ac_p53
intersections_h3k27ac_p53
temp
closest_DEgene_sh1 <- read_delim("question2/3-closest_DE_gene/closest_DEgene_sh1.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
colnames(closest_DEgene_sh1) <- c("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "name_h3k27ac",
"chr_gene", "start_gene", "end_gene", "name_gene", "nd", "strand", "distance")
View(a)
View(closest_DEgene_sh1)
temp <- closest_DEgene_sh1 %>%
select("name_h3k27ac", "chr_gene", "start_gene", "end_gene", "name_gene", "distance")
intersections_h3k27ac_p53
intersections_h3k27ac_p53 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene" = "gene"))
intersections_h3k27ac_p53 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene" = "gene")) %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "name_gene", "log2FoldChange", "distance") %>%
mutate(name_gene = substr(name_gene, 0, 15))
intersections_h3k27ac_p53 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene" = "gene")) %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "name_gene", "log2FoldChange", "distance") %>%
mutate(name_gene = substr(name_gene, 0, 15)) %>%
inner_join(gene_symbol_Enseml_mapping, by = c("name_gene" = "X1")) %>%
rename("gene name" = "X2") %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "gene name", "log2FoldChange", "distance")
closest_DEgene_sh2 <- read_delim("question2/3-closest_DE_gene/closest_DEgene_sh2.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
colnames(closest_DEgene_sh2) <- c("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "name_h3k27ac",
"chr_gene", "start_gene", "end_gene", "name_gene", "nd", "strand", "distance")
temp <- closest_DEgene_sh2 %>%
select("name_h3k27ac", "chr_gene", "start_gene", "end_gene", "name_gene", "distance")
table1_sh2 <- intersections_h3k27ac_p53 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh2, by = c("name_gene" = "gene")) %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "name_gene", "log2FoldChange", "distance") %>%
mutate(name_gene = substr(name_gene, 0, 15)) %>%
inner_join(gene_symbol_Enseml_mapping, by = c("name_gene" = "X1")) %>%
rename("gene name" = "X2") %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "gene name", "log2FoldChange", "distance")
DESeq2_DE_sh2 <- read_delim("question1/aux/DESeq2_DE_sh2.txt",
"\t", escape_double = FALSE, trim_ws = TRUE)
closest_DEgene_sh1 <- read_delim("question2/3-closest_DE_gene/closest_DEgene_sh1.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
colnames(closest_DEgene_sh1) <- c("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "name_h3k27ac",
"chr_gene", "start_gene", "end_gene", "name_gene", "nd", "strand", "distance")
temp <- closest_DEgene_sh1 %>%
select("name_h3k27ac", "chr_gene", "start_gene", "end_gene", "name_gene", "distance")
table1 <- intersections_h3k27ac_p53 %>%
inner_join(temp, by = c("name_h3k27ac" = "name_h3k27ac")) %>%
inner_join(DESeq2_DE_sh1, by = c("name_gene" = "gene")) %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "name_gene", "log2FoldChange", "distance") %>%
mutate(name_gene = substr(name_gene, 0, 15)) %>%
inner_join(gene_symbol_Enseml_mapping, by = c("name_gene" = "X1")) %>%
rename("gene name" = "X2") %>%
select("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "start_p53", "end_p53", "gene name", "log2FoldChange", "distance")
table1
table1 %>% filter(chr_h3k27ac == "chr8") %>% filter(start_h3k27ac >= b1 & end_h3k27ac <= b2)
genes_within_1MB_sh1 <- genes_within_1MB_sh1 %>%
mutate(isDE = X8 %in% DE_common_sh1$X4)
genes_within_1MB_sh1 <- read_table2("question2/4-genes_within_1MB_from_2/genes_within_1MB_sh1.txt",
col_names = FALSE)
genes_within_1MB_sh1 <- genes_within_1MB_sh1 %>%
mutate(isDE = X8 %in% DE_common_sh1$X4)
genes_within_1MB_sh1
a <- genes_within_1MB_sh1 %>%
dplyr::group_by(chr_h, start_h, end_h, region_name) %>%
dplyr::summarise(nGenes = n(), nGenesDE = sum(isGeneDE[isGeneDE])) %>%
dplyr::mutate(fractionOfDEPercent = 100 * nGenesDE / nGenes) %>%
dplyr::filter(nGenes >= 10) %>%
dplyr::arrange(-fractionOfDEPercent)
colnames(genes_within_1MB_sh1) <- c("chr_h", "start_h", "end_h", "region_name",
"chr_g", "start_g", "end_g", "gene_name",
"nd", "gene_strand", "distance", "isGeneDE" )
a <- genes_within_1MB_sh1 %>%
dplyr::group_by(chr_h, start_h, end_h, region_name) %>%
dplyr::summarise(nGenes = n(), nGenesDE = sum(isGeneDE[isGeneDE])) %>%
dplyr::mutate(fractionOfDEPercent = 100 * nGenesDE / nGenes) %>%
dplyr::filter(nGenes >= 10) %>%
dplyr::arrange(-fractionOfDEPercent)
a
closest_DEgene_sh2 <- read_delim("question2/3-closest_DE_gene/closest_DEgene_sh2.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
colnames(closest_DEgene_sh2) <- c("chr_h3k27ac", "start_h3k27ac", "end_h3k27ac", "name_h3k27ac",
"chr_gene", "start_gene", "end_gene", "name_gene", "nd", "strand", "distance")
genes_within_1MB_sh2 <- genes_within_1MB_sh2 %>%
mutate(isDE = X8 %in% DE_common_sh2$X4)
genes_within_1MB_sh2 <- read_table2("question2/4-genes_within_1MB_from_2/genes_within_1MB_sh2.txt",
col_names = FALSE)
genes_within_1MB_sh2 <- genes_within_1MB_sh2 %>%
mutate(isDE = X8 %in% DE_common_sh2$X4)
colnames(genes_within_1MB_sh2) <- c("chr_h", "start_h", "end_h", "region_name",
"chr_g", "start_g", "end_g", "gene_name",
"nd", "gene_strand", "distance", "isGeneDE" )
a <- genes_within_1MB_sh1 %>%
dplyr::group_by(chr_h, start_h, end_h, region_name) %>%
dplyr::summarise(nGenes = n(), nGenesDE = sum(isGeneDE[isGeneDE])) %>%
dplyr::mutate(fractionOfDEPercent = 100 * nGenesDE / nGenes) %>%
dplyr::filter(nGenes >= 10) %>%
dplyr::arrange(-fractionOfDEPercent)
a

macs_up %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(macs_up))
ggplot(macs_dw, aes(x="", y=n, fill=X10))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0)
macs_dw
macs_dw <- macs_dw %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(macs_dw))
ggplot(macs_dw, aes(x="", y=n, fill=X10))+
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start=0)
macs_dw
macs_up <- macs_up %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(macs_up))
s1_dw <- macs_dw %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(s1_dw))
s1_dw
s1_dw <- read_delim("gencodeV35/random_regions/len_variable/sample1official/closest_genes_downstream.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
s1_dw <- s1_dw %>% filter(X8 != ".")
s1_dw <- s1_dw %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(s1_dw))
View(s1_dw)
macs_dw <- read_delim("gencodeV35/bedtools/closest_genes_downstream.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
macs_up <- read_delim("gencodeV35/bedtools/closest_genes_upstream.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
s1_dw <- read_delim("gencodeV35/random_regions/len_variable/sample1official/closest_genes_downstream.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
s1_up <- read_delim("gencodeV35/random_regions/len_variable/sample1official/closest_genes_upstream.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
s2_dw <- read_delim("gencodeV35/random_regions/len_variable/sample2/closest_genes_downstream.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
s2_up <- read_delim("gencodeV35/random_regions/len_variable/sample2/closest_genes_upstream.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
s3_dw <- read_delim("gencodeV35/random_regions/len_variable/sample3/closest_genes_downstream.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
s3_up <- read_delim("gencodeV35/random_regions/len_variable/sample3/closest_genes_upstream.txt",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
macs_dw <- macs_dw %>% filter(X8 != ".")
macs_up <- macs_up %>% filter(X8 != ".")
s1_dw <- s1_dw %>% filter(X8 != ".")
s1_up <- s1_up %>% filter(X8 != ".")
s2_dw <- s2_dw %>% filter(X8 != ".")
s2_up <- s2_up %>% filter(X8 != ".")
s3_dw <- s3_dw %>% filter(X8 != ".")
s3_up <- s3_up %>% filter(X8 != ".")
macs_dw <- macs_dw %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(macs_dw))
macs_up <- macs_up %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(macs_up))
s1_dw <- s1_dw %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(s1_dw))
s1_up <- s1_up %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(s1_up))
s2_dw <- s2_dw %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(s2_dw))
s2_up <- s2_up %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(s2_up))
s3_dw <- s3_dw %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(s3_dw))
s3_up <- s3_up %>% group_by(X10) %>% count() %>% arrange(-n) %>% mutate(ratio = n/nrow(s3_up))
View(s1_dw)
View(s1_up)
View(macs_dw)
View(macs_up)
View(s2_dw)
View(s2_up)
View(s3_dw)
View(s3_up)
macs_dw
macs_dw %>% inner_join(s1_dw, by = c("X10" = "X10" ))
macs_dw %>%
inner_join(s1_dw, by = c("X10" = "X10")) %>%
inner_join(s2_dw, by = c("X10" = "X10")) %>%
inner_join(s3_dw, by = c("X10" = "X10"))
macs_dw %>%
inner_join(s1_dw, by = c("X10" = "X10")) %>%
inner_join(s2_dw, by = c("X10" = "X10")) %>%
inner_join(s3_dw, by = c("X10" = "X10")) %>%
dplyr::select(X10, ratio.x, ratio.y, ratio.x.x, ratio.y.y)
macs_up %>%
inner_join(s1_up, by = c("X10" = "X10")) %>%
inner_join(s2_up, by = c("X10" = "X10")) %>%
inner_join(s3_up, by = c("X10" = "X10")) %>%
dplyr::select(X10, ratio.x, ratio.y, ratio.x.x, ratio.y.y)
bedtools_intersect_r1 <- read_delim("gencodeV35/random_regions/len_variable/sample1official/bedtools_intersect.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
View(bedtools_intersect_r1)
bedtools_intersect_r1 %>% group_by(X9,X10) %>% summarise(m = n())
bedtools_intersect_r1 %>% group_by(X9,X10) %>% summarise(m = n()) %>% filter(X10 == "protein_coding")
bedtools_intersect_r1 %>% group_by(X9,X10) %>% summarise(m = n()) %>% filter(X10 == "lncRNA")
library(readr)
annotation_v35 <- read_delim("gencodeV35/annotation.bed",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
View(annotation_v35)
annotation_v35 %>% group_by(X5,X6)
annotation_v35 %>% group_by(X5,X6) %>% summarise(m = n())
(annotation_v35 %>% group_by(X5,X6) %>% summarise(m = n())) %>% group_by(X6) %>% count() %>% arrange(-n)
tot_v35 <- (annotation_v35 %>% group_by(X5,X6) %>% summarise(m = n())) %>% group_by(X6) %>% count() %>% arrange(-n)
library(readr)
intersect_r1_v35 <- read_delim("gencodeV35/random_regions/len_variable/sample1official/bedtools_intersect.bed",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
View(intersect_r1_v35)
(intersect_r1_v35 %>% group_by(X5,X6) %>% summarise(m = n())) %>% group_by(X6) %>% count() %>% arrange(-n)
(intersect_r1_v35 %>% group_by(X9,X10) %>% summarise(m = n())) %>% group_by(X10) %>% count() %>% arrange(-n)
r1 <- (intersect_r1_v35 %>% group_by(X9,X10) %>% summarise(m = n())) %>% group_by(X10) %>% count() %>% arrange(-n)
View(tot_v35)
View(r1)
tot_v35 %>% inner_join(r1, by = c("X6" = "X10"))
tot_v35 %>% inner_join(r1, by = c("X6" = "X10")) %>% mutate(ratio = n.y/n.x)
annotation_v35 <- read_delim("gencodeV35/annotation.bed", "\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
View(intersect_r1_v35)
annotation_v35 <- read_delim("gencodeV35/annotation.bed", "\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
macs <- read_delim("gencodeV35/bedtools/bedtools_intersect.bed", "\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
inter_r1 <- read_delim("gencodeV35/random_regions/len_variable/sample1official/bedtools_intersect.bed", "\t",
escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
inter_r2 <- read_delim("gencodeV35/random_regions/len_variable/sample2/bedtools_intersect.bed", "\t",
escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
inter_r3 <- read_delim("gencodeV35/random_regions/len_variable/sample3/bedtools_intersect.bed", "\t",
escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
tot_v35 <- (annotation_v35 %>% group_by(X5,X6) %>% summarise(m = n())) %>% group_by(X6) %>% count() %>% arrange(-n)
View(tot_v35)
tot_v35 <- (annotation_v35 %>% group_by(X5,X6) %>% summarise(m = n())) %>% group_by(X6) %>% count() %>% arrange(-n)
r1 <- (inter_r1 %>% group_by(X9,X10) %>% summarise(m = n())) %>% group_by(X10) %>% count() %>% arrange(-n)
r2 <- (inter_r2 %>% group_by(X9,X10) %>% summarise(m = n())) %>% group_by(X10) %>% count() %>% arrange(-n)
r3 <- (inter_r3 %>% group_by(X9,X10) %>% summarise(m = n())) %>% group_by(X10) %>% count() %>% arrange(-n)
tot_v35 %>%
inner_join(r1, by = c("X6" = "X10"))
tot_v35 %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10"))
tot_v35 %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_r1 = n.y/n.x)
tot_v35 %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_r1 = n.y/n.x) %>%
mutate(ratio_r2 = n.x.x/n.x) %>%
mutate(ratio_r3 = n.y.y/n.x)
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_r1 = n.y/n.x) %>%
mutate(ratio_r2 = n.x.x/n.x) %>%
mutate(ratio_r3 = n.y.y/n.x)
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10"))
macs <- (inter_macs %>% group_by(X9,X10) %>% summarise(m = n())) %>% group_by(X10) %>% count() %>% arrange(-n)
inter_macs <- read_delim("gencodeV35/bedtools/bedtools_intersect.bed", "\t", escape_double = FALSE,
col_names = FALSE, trim_ws = TRUE)
macs <- (inter_macs %>% group_by(X9,X10) %>% summarise(m = n())) %>% group_by(X10) %>% count() %>% arrange(-n)
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_r1 = n.y/n.x) %>%
mutate(ratio_r2 = n.x.x/n.x) %>%
mutate(ratio_r3 = n.y.y/n.x)
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_macs = n.y/n.x) %>%
mutate(ratio_r1 = n.x.x/n.x) %>%
mutate(ratio_r2 = n.y.y/n.x) # %>%
r1
r3
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_macs = n.y/n.x) %>%
mutate(ratio_r1 = n.x.x/n.x) %>%
mutate(ratio_r2 = n.y.y/n.x) %>%
mutate(ratio_r3 = n/n.x) %>%
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_macs = n.y/n.x) %>%
mutate(ratio_r1 = n.x.x/n.x) %>%
mutate(ratio_r2 = n.y.y/n.x) %>%
mutate(ratio_r3 = n/n.x)
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_macs = n.y/n.x) %>%
mutate(ratio_r1 = n.x.x/n.x) %>%
mutate(ratio_r2 = n.y.y/n.x) %>%
mutate(ratio_r3 = n/n.x)
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_macs = n.y/n.x) %>%
mutate(ratio_r1 = n.x.x/n.x) %>%
mutate(ratio_r2 = n.y.y/n.x) %>%
mutate(ratio_r3 = n/n.x) %>%
dplyr::select(X6, n.x, n.y, ratio_macs)
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_macs = n.y/n.x) %>%
mutate(ratio_r1 = n.x.x/n.x) %>%
mutate(ratio_r2 = n.y.y/n.x) %>%
mutate(ratio_r3 = n/n.x)
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_macs = n.y/n.x) %>%
mutate(ratio_r1 = n.x.x/n.x) %>%
mutate(ratio_r2 = n.y.y/n.x) %>%
mutate(ratio_r3 = n/n.x) %>%
dplyr::select(X6, n.x, n.y, ratio_macs, n.x.x, ratio_r1, n.y.y, ratio_r2, n, ratio_r3)
annotation_merged <- read_delim("gencodeV35/monte_annotation_merge_genes/annotation.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
View(annotation_merged)
annotation_merged <- annotation_merged %>% mutate(len = X3-X2)
annotation_merged %>% group_by(X5) %>% summarise(mean = mean(len), median = median(len))
annotation_merged %>%
group_by(X5) %>%
summarise(mean = mean(len), median = median(len)) %>%
arrange(mean)
annotation_merged %>%
group_by(X5) %>%
summarise(mean = mean(len), median = median(len)) %>%
arrange(-mean)
annotation_merged %>%
group_by(X5) %>%
summarise(count = n(), mean = mean(len), median = median(len)) %>%
arrange(-mean)
annotation_merged %>%
group_by(X5) %>%
summarise(count = n(), mean_len = mean(len), median_len = median(len)) %>%
arrange(-mean)
annotation_merged %>%
group_by(X5) %>%
summarise(count = n(), mean_len = mean(len), median_len = median(len)) %>%
arrange(-mean_len)
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_macs = n.y/n.x) %>%
mutate(ratio_r1 = n.x.x/n.x) %>%
mutate(ratio_r2 = n.y.y/n.x) %>%
mutate(ratio_r3 = n/n.x) %>%
dplyr::select(X6, n.x, n.y, ratio_macs, n.x.x, ratio_r1, n.y.y, ratio_r2, n, ratio_r3)
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_macs = n.y/n.x) %>%
mutate(ratio_r1 = n.x.x/n.x) %>%
mutate(ratio_r2 = n.y.y/n.x) %>%
mutate(ratio_r3 = n/n.x) %>%
dplyr::select(X6, n.x, n.y, ratio_macs, n.x.x, ratio_r1, n.y.y, ratio_r2, n, ratio_r3)
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_macs = n.y/n.x) %>%
mutate(ratio_r1 = n.x.x/n.x) %>%
mutate(ratio_r2 = n.y.y/n.x) %>%
mutate(ratio_r3 = n/n.x) %>%
dplyr::select(X6, n.x, n.y, ratio_macs, n.x.x, ratio_r1, n.y.y, ratio_r2, n, ratio_r3)
tot_v35 %>%
inner_join(macs, by = c("X6" = "X10")) %>%
inner_join(r1, by = c("X6" = "X10")) %>%
inner_join(r2, by = c("X6" = "X10")) %>%
inner_join(r3, by = c("X6" = "X10")) %>%
mutate(ratio_macs = n.y/n.x) %>%
mutate(ratio_r1 = n.x.x/n.x) %>%
mutate(ratio_r2 = n.y.y/n.x) %>%
mutate(ratio_r3 = n/n.x) %>%
dplyr::select(X6, n.x, n.y, ratio_macs, n.x.x, ratio_r1, n.y.y, ratio_r2, n, ratio_r3)
annotation_merged %>%
group_by(X5) %>%
summarise(count = n(), mean_len = mean(len), median_len = median(len)) %>%
arrange(-mean_len)
annotation_merged %>%
group_by(X5) %>%
summarise(count = n(), mean_len = mean(len), median_len = median(len)) %>%
arrange(-count)
setwd("/mnt/hdd0/univ/thesis-support-material/data")
library(readr)
gencode_v35 <- read_delim("4-3/gencode/gencode-v35.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
gencode_v24 <- read_delim("4-3/gencode/gencode-v24.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
gencode_v35
library(dplyr)
library(ggplot2)
gencode_v35
gencode_v35 %>% group_by(X5,X6)
gencode_v35 %>% group_by(X5,X6) %>% count() %>% nrow(.)
gencode_v35 %>% group_by(X5) %>% count() %>% nrow(.)
gencode_v24 %>% group_by(X5) %>% count() %>% nrow(.)
gencode_v35 %>% nrow(.)
intersections_p53_v35 <- read_delim("4-3/bedtools-intersect/with-v35/intersections-p53-v35.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
intersections_p53_v24 <- read_delim("4-3/bedtools-intersect/with-v35/intersections-p53-v24.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
intersections_p53_v24 <- read_delim("4-3/bedtools-intersect/with-v24/intersections-p53-v24.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
p53_no_intersections <- read_delim("4-3/bedtools-intersect/with-v35/p53-no-intersections.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
p53_no_intersections_v24 <- read_delim("4-3/bedtools-intersect/with-v24/p53-no-intersections.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
intersections_p53_v35
intersections_p53_v35 %>% group_by(X4,X9,X10)
intersections_p53_v35 %>% group_by(X4,X9,X10) %>% count()
intersections_p53_v24 %>% group_by(X4,X9,X10) %>% count()
merged_v35 <- read_delim("4-3/gencode/merged-annotation/merged-v35.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
merged_v24 <- read_delim("4-3/gencode/merged-annotation/merged-v24.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
intersections_p53_merged_v35 <- read_delim("4-3/bedtools-intersect/with-merged-v35/intersections-p53-v35.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
intersections_p53_merged_v24 <- read_delim("4-3/bedtools-intersect/with-merged-v24/intersections-p53-v24.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
intersections_p53_merged_v35
intersections_p53_merged_v35 %>% group_by(X8,X9) %>% count()
(intersections_p53_merged_v35 %>% group_by(X8,X9) %>% count()) %>%
group_by(X9)
(intersections_p53_merged_v35 %>% group_by(X8,X9) %>% count()) %>%
group_by(X9) %>% count()
(intersections_p53_merged_v35 %>% group_by(X8,X9) %>% count()) %>%
group_by(X9) %>% count() %>% arrange(-n)
intersections_p53_merged_v35
(intersections_p53_merged_v35 %>% group_by(X9) %>% count()) %>%
group_by(X9) %>% count() %>% arrange(-n)
(intersections_p53_merged_v35 %>% group_by(X9) %>% count())
(intersections_p53_merged_v35 %>% group_by(X9) %>% count() %>% arrange(-n)
)
intersections_p53_merged_v35 %>% group_by(X9) %>% count() %>% arrange(-n)
intersections_p53_merged_v35
merged_v35
merged_v35 %>% group_by(X4,X5)
merged_v35 %>% group_by(X4,X5) %>% count()
(merged_v35 %>% group_by(X4,X5) %>% count()) %>% group_by(X5) %>% count()
(merged_v35 %>% group_by(X4,X5) %>% count()) %>% group_by(X5) %>% count() %>% arrange(-n)
gencode_v35
gencode_v35 %>% filter(X5 == "snoU13")
gencode_v35 %>% filter(X5 == "snoU13") %>% group_by(X1) %>% summarise(count = n(), avglen = mean(X3-X2))
merged_v35
View(merged_v35)
merged_v35 %>% group_by(X5) %>% summarise(count = n(), avglen = mean(X3-X2))
merged_v35 %>% group_by(X5) %>% summarise(count = n(), avglen = mean(X3-X2)) %>% arrange(-avglen)
intersections_p53_merged_v35
View(intersections_p53_v35)
intersections_p53_merged_v35 %>% filter(X10 != "snoRNA", X10 != "misc_RNA")
View(intersections_p53_merged_v24)
intersections_p53_merged_v35
intersections_p53_merged_v35 %>% filter(X9 != "snoRNA", X9 != "misc_RNA")
intersections_p53_merged_v24 %>% filter(X9 != "snoRNA", X9 != "misc_RNA")
p53_sites <- read_delim("4-3/sites/p53-sites.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
summary(p53_sites)
View(p53_sites)
p53_sites <- p53_sites %>% mutate(len = X3-X2)
summary(p53_sites$len)
p53_sites_filtered <- p53_sites %>% filter(len <= 1000)
p53_sites_filtered
percents <- seq(from = 0, to = 1, by = 0.01)
quantile(p53_sites$len, probs = percents)
# 98th percentiles is <= 1000
quantile(p53_sites$len, probs = percents)['98%']
rm(percents)
quantile(p53_sites$len, probs = percents)['98%']
# 98th percentiles is <= 1000
percents <- seq(from = 0, to = 1, by = 0.01)
quantile(p53_sites$len, probs = percents)['98%']
rm(percents)
#boxplot length distribution
data.frame(sample = "actual", length = p53_sites$len) %>%
ggplot(aes(x = sample, y = length, fill = sample)) +
geom_boxplot() +
scale_fill_manual(values = c("coral3")) +
theme(legend.position="none") +
labs(title = "Length distribution of the estimated p53 binding sites", x = "sample", y = "length")
library(gamlss)
library(gamlss.dist)
library(gamlss.add)
ex_fit <- fitDist(p53_sites_filtered$len, k = 2, type = "realplus", trace = FALSE, try.gamlss = TRUE)
summary(ex_fit)
# random samples generation
ex_sample <- rGG(n = length(p53_sites_filtered$len),
mu = exp(ex_fit$mu.coefficients),
sigma = exp(ex_fit$sigma.coefficients),
nu = ex_fit$nu.coefficients
)
View(ex_fit)
# removal of Inf values
ex_sample <- ex_sample[ex_sample != Inf]
rm(ex_sample)
# random samples generation
random_sample_1 <- rGG(n = length(p53_sites_filtered$len),
mu = exp(ex_fit$mu.coefficients),
sigma = exp(ex_fit$sigma.coefficients),
nu = ex_fit$nu.coefficients )
# removal of Inf values
random_sample_1 <- random_sample_1[random_sample_1 != Inf]
random_sample_2 <- rGG(n = length(p53_sites_filtered$len),
mu = exp(ex_fit$mu.coefficients),
sigma = exp(ex_fit$sigma.coefficients),
nu = ex_fit$nu.coefficients )
random_sample_3 <- rGG(n = length(p53_sites_filtered$len),
mu = exp(ex_fit$mu.coefficients),
sigma = exp(ex_fit$sigma.coefficients),
nu = ex_fit$nu.coefficients )
# removal of Inf values
random_sample_1 <- random_sample_1[random_sample_1 != Inf]
random_sample_2 <- random_sample_2[random_sample_2 != Inf]
random_sample_3 <- random_sample_3[random_sample_3 != Inf]
df <- data.frame(sample = "actual", length = p53_sites_filtered$len)
df
df
df <- data.frame(sample = "actual", length = p53_sites_filtered$len)
df <- rbind(df, data.frame(sample = "random 1", length = random_sample_1))
df <- rbind(df, data.frame(sample = "random 2", length = random_sample_2))
df <- rbind(df, data.frame(sample = "random 3", length = random_sample_3))
View(df)
ggplot(df, aes(x = sample, y = length, fill = sample)) +
geom_boxplot() +
scale_fill_manual(values = c("coral3", "dodgerblue1", "dodgerblue2", "dodgerblue3")) +
theme(legend.position="none") +
labs(title = "Length distribution of the estimated p53 binding sites \n compared to the random samples", x = "sample", y = "length")
rm(df)
ggplot(df, aes(x = length, fill = sample)) +
geom_density(alpha = 0.4, position = "identity") +
scale_fill_manual(values = c("coral3", "dodgerblue1", "dodgerblue2", "dodgerblue3")) +
theme(legend.position = c(0.9, 0.85)) +
labs(title = "Length distribution of the estimated p53 binding sites \n compared to random samples")
ggplot(df, aes(x = length, fill = sample)) +
geom_density(alpha = 0.4, position = "identity") +
scale_fill_manual(values = c("coral3", "dodgerblue1", "dodgerblue2", "dodgerblue3")) +
theme(legend.position = c(0.9, 0.85)) +
labs(title = "Length distribution of the estimated p53 binding sites \n compared to random samples")
# comparison of the distribution in the samples, boxplots
df <- data.frame(sample = "actual", length = p53_sites_filtered$len)
df <- rbind(df, data.frame(sample = "random 1", length = random_sample_1))
df <- rbind(df, data.frame(sample = "random 2", length = random_sample_2))
df <- rbind(df, data.frame(sample = "random 3", length = random_sample_3))
ggplot(df, aes(x = length, fill = sample)) +
geom_density(alpha = 0.4, position = "identity") +
scale_fill_manual(values = c("coral3", "dodgerblue1", "dodgerblue2", "dodgerblue3")) +
theme(legend.position = c(0.9, 0.85)) +
labs(title = "Length distribution of the estimated p53 binding sites \n compared to random samples")
random_sample_1
rGG(n = length(p53_sites_filtered$len),
mu = exp(ex_fit$mu.coefficients),
sigma = exp(ex_fit$sigma.coefficients),
nu = ex_fit$nu.coefficients )
a <- rGG(n = length(p53_sites_filtered$len),
mu = exp(ex_fit$mu.coefficients),
sigma = exp(ex_fit$sigma.coefficients),
nu = ex_fit$nu.coefficients )
summary(a)
a <- a[a != Inf]
a
summary(a)
qqplot(p53_sites_filtered$len, random_sample_1,
main = "Comparison of distribution quantiles: \n binding sites length distribution vs random sample from the fitted model",
xlab = "Lengths of the estimated binding sites",
ylab = "Lengths of the regions in the random samples")
abline(0, 1, col = 'red')
rm(df)
rm(a)
View(intersections_p53_v35)
intersections_p53_v35
intersections_p53_v35 %>% group_by(X9,X10)
intersections_p53_v35 %>% group_by(X9,X10) %>% count()
(intersections_p53_v35 %>% group_by(X9,X10) %>% count()) %>%
group_by(X10) %>% count()
(intersections_p53_v35 %>% group_by(X9,X10) %>% count()) %>%
group_by(X10) %>% count() %>% arrange(-n)
gencode_v35
gencode_v35 %>% group_by(X5,X6) %>% count()
(gencode_v35 %>% group_by(X5,X6) %>% count()) %>%
group_by(X6) %>% count()
(gencode_v35 %>% group_by(X5,X6) %>% count()) %>%
group_by(X6) %>% count() %>% arrange(-n)
p1 <- (intersections_p53_v35 %>% group_by(X9,X10) %>% count()) %>%
group_by(X10) %>% count() %>% arrange(-n)
p2 <- (gencode_v35 %>% group_by(X5,X6) %>% count()) %>%
group_by(X6) %>% count() %>% arrange(-n)
p1 %>% inner_join(p2, by = c("X6" = "X6"))
p1
p2
p1 %>% inner_join(p2, by = c("X10" = "X6"))
p1 %>% inner_join(p2, by = c("X10" = "X6")) %>% mutate(ratio = n.x/n.y)
rm(p1)
rm(p2)
random_sample1 <- read_delim("4-3/sites/random-sites-samples/sample1.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
random_sample2 <- read_delim("4-3/sites/random-sites-samples/sample2.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
random_sample3 <- read_delim("4-3/sites/random-sites-samples/sample3.bed",
"\t", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)
